<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TESTER PRO - Interactive Interface</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0a0c15;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
        }
        
        .device-container {
            background: #000;
            border-radius: 30px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.8);
            position: relative;
            transform: scale(1.2);
        }
        
        .interface {
            width: 1920px;
            height: 960px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: #1a1d29;
            border-radius: 20px;
            padding: 40px;
        }
        
        /* Encoders */
        .encoder {
            width: 280px;
            height: 280px;
            position: relative;
            cursor: pointer;
            user-select: none;
        }
        
        .encoder-outer {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, #3a4152, #2a3142);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5), inset 0 -5px 10px rgba(0,0,0,0.3);
            position: relative;
            transition: transform 0.1s;
            border: 15px solid #1a1d29;
            outline: 3px solid #4a5568;
            outline-offset: -18px;
        }
        
        .encoder-outer:active {
            transform: scale(0.95);
            box-shadow: 0 5px 15px rgba(0,0,0,0.5), inset 0 -2px 5px rgba(0,0,0,0.3);
        }
        
        .encoder-inner {
            position: absolute;
            top: 105px;
            left: 105px;
            right: 105px;
            bottom: 105px;
            border-radius: 50%;
            background: radial-gradient(circle at 40% 40%, #4a5568, #374151);
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: transform 0.3s ease;
            pointer-events: none; /* Make inner area non-clickable */
        }
        
        /* Encoder dots around the ring */
        .encoder-dots {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
        }
        
        .encoder-dot {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #2a3142;
            border-radius: 50%;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            transform-origin: 50% 130px;
            transition: all 0.3s ease;
            box-shadow: 0 0 5px rgba(0,0,0,0.3);
        }
        
        .encoder-dot.active {
            background: #4a9eff;
            width: 10px;
            height: 10px;
            box-shadow: 0 0 10px #4a9eff;
        }
        
        .encoder.right .encoder-dot.active {
            background: #00ff00;
            box-shadow: 0 0 10px #00ff00;
        }
        
        /* Create 24 dots (every 15 degrees) */
        .encoder-dot:nth-child(1) { transform: translateX(-50%) rotate(0deg); }
        .encoder-dot:nth-child(2) { transform: translateX(-50%) rotate(15deg); }
        .encoder-dot:nth-child(3) { transform: translateX(-50%) rotate(30deg); }
        .encoder-dot:nth-child(4) { transform: translateX(-50%) rotate(45deg); }
        .encoder-dot:nth-child(5) { transform: translateX(-50%) rotate(60deg); }
        .encoder-dot:nth-child(6) { transform: translateX(-50%) rotate(75deg); }
        .encoder-dot:nth-child(7) { transform: translateX(-50%) rotate(90deg); }
        .encoder-dot:nth-child(8) { transform: translateX(-50%) rotate(105deg); }
        .encoder-dot:nth-child(9) { transform: translateX(-50%) rotate(120deg); }
        .encoder-dot:nth-child(10) { transform: translateX(-50%) rotate(135deg); }
        .encoder-dot:nth-child(11) { transform: translateX(-50%) rotate(150deg); }
        .encoder-dot:nth-child(12) { transform: translateX(-50%) rotate(165deg); }
        .encoder-dot:nth-child(13) { transform: translateX(-50%) rotate(180deg); }
        .encoder-dot:nth-child(14) { transform: translateX(-50%) rotate(195deg); }
        .encoder-dot:nth-child(15) { transform: translateX(-50%) rotate(210deg); }
        .encoder-dot:nth-child(16) { transform: translateX(-50%) rotate(225deg); }
        .encoder-dot:nth-child(17) { transform: translateX(-50%) rotate(240deg); }
        .encoder-dot:nth-child(18) { transform: translateX(-50%) rotate(255deg); }
        .encoder-dot:nth-child(19) { transform: translateX(-50%) rotate(270deg); }
        .encoder-dot:nth-child(20) { transform: translateX(-50%) rotate(285deg); }
        .encoder-dot:nth-child(21) { transform: translateX(-50%) rotate(300deg); }
        .encoder-dot:nth-child(22) { transform: translateX(-50%) rotate(315deg); }
        .encoder-dot:nth-child(23) { transform: translateX(-50%) rotate(330deg); }
        .encoder-dot:nth-child(24) { transform: translateX(-50%) rotate(345deg); }
        
        .encoder-label {
            font-size: 32px;
            font-weight: bold;
            color: #fff;
            text-align: center;
        }
        
        .encoder-sublabel {
            font-size: 18px;
            color: #9ca3af;
            margin-top: 5px;
        }
        
        .encoder-indicator {
            position: absolute;
            width: 10px;
            height: 50px;
            background: #4a9eff;
            border-radius: 5px;
            top: 15px;
            left: 50%;
            transform: translateX(-50%);
            transform-origin: 50% 125px;
            box-shadow: 0 0 15px #4a9eff;
            transition: transform 0.3s ease;
        }
        
        .encoder.right .encoder-indicator {
            background: #00ff00;
            box-shadow: 0 0 10px #00ff00;
        }
        
        .encoder-info {
            text-align: center;
            margin-top: 20px;
            color: #6b7280;
            font-size: 14px;
        }
        
        /* LCD Display */
        .lcd-container {
            flex: 1;
            max-width: 1300px;
            height: 480px;
            background: #0a0c15;
            border-radius: 20px;
            border: 3px solid #2a3142;
            padding: 30px;
            margin: 0 50px;
            position: relative;
            overflow: hidden;
            box-shadow: inset 0 0 30px rgba(0,0,0,0.8);
        }
        
        .lcd-content {
            height: 100%;
            display: flex;
            gap: 30px;
        }
        
        .menu-section {
            width: 350px;
            background: #1a1d29;
            border-radius: 15px;
            padding: 25px;
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        .submenu-section {
            width: 350px;
            background: #1a1d29;
            border-radius: 15px;
            padding: 25px;
            display: none;
            flex-direction: column;
            height: 100%;
        }
        
        .submenu-section.active {
            display: flex;
        }
        
        .breadcrumb {
            font-size: 14px;
            color: #6b7280;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .breadcrumb-separator {
            color: #4a5568;
        }
        
        .menu-title {
            font-size: 26px;
            font-weight: bold;
            color: #fff;
            margin-bottom: 25px;
        }
        
        .menu-item {
            background: #2a3142;
            border: 2px solid transparent;
            border-radius: 12px;
            padding: 18px 25px;
            margin-bottom: 18px;
            color: #fff;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .menu-item:hover {
            background: #3a4152;
            border-color: #4a5568;
        }
        
        .menu-item.active {
            background: #2a3552;
            border-color: #4a9eff;
            box-shadow: 0 0 20px rgba(74, 158, 255, 0.3);
        }
        
        .menu-icon {
            font-size: 20px;
        }
        
        .center-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 0 30px;
        }
        
        .center-content {
            text-align: center;
            transition: opacity 0.3s ease;
        }
        
        .content-icon {
            font-size: 80px;
            margin-bottom: 20px;
        }
        
        .content-title {
            font-size: 28px;
            font-weight: bold;
            color: #fff;
            margin-bottom: 10px;
        }
        
        .content-description {
            font-size: 16px;
            color: #9ca3af;
            margin-bottom: 20px;
            line-height: 1.6;
        }
        
        .content-details {
            background: #1a1d29;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            border: 1px solid #2a3142;
        }
        
        .logo {
            width: 100px;
            height: 100px;
            background: #4a9eff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 50px;
            color: #fff;
            margin-bottom: 20px;
            box-shadow: 0 0 30px rgba(74, 158, 255, 0.5);
        }
        
        .system-title {
            font-size: 32px;
            font-weight: bold;
            color: #fff;
            margin-bottom: 10px;
        }
        
        .system-subtitle {
            font-size: 16px;
            color: #9ca3af;
            margin-bottom: 5px;
        }
        
        .system-version {
            font-size: 14px;
            color: #6b7280;
        }
        
        .data-section {
            flex: 0.8;
            background: #1a1d29;
            border-radius: 15px;
            padding: 25px;
        }
        
        .data-title {
            font-size: 20px;
            font-weight: bold;
            color: #fff;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .pressure-item {
            background: #0f1118;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .pressure-label {
            font-size: 14px;
            color: #9ca3af;
            margin-bottom: 5px;
        }
        
        .pressure-value {
            font-size: 32px;
            font-weight: bold;
            color: #fff;
            margin-bottom: 5px;
        }
        
        .pressure-unit {
            font-size: 14px;
            color: #6b7280;
        }
        
        .system-status {
            background: #0f1118;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            color: #00ff00;
            font-size: 18px;
            font-weight: bold;
        }
        
        /* Clickable ring area */
        .encoder-ring {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 50%;
            cursor: grab;
            z-index: 5;
            clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%, 0 0, 
                              105px 105px, 105px 175px, 175px 175px, 175px 105px, 105px 105px);
        }
        
        .encoder-ring:active {
            cursor: grabbing;
        }
        
        /* Visual feedback for clickable area */
        .encoder-ring:hover ~ .encoder-dots .encoder-dot {
            background: #3a4152;
        }
        
        .encoder.right .encoder-ring:hover ~ .encoder-dots .encoder-dot {
            background: #2a4532;
        }
        
        /* Center button for mode switching */
        .encoder-center-button {
            position: absolute;
            top: 105px;
            left: 105px;
            right: 105px;
            bottom: 105px;
            border-radius: 50%;
            cursor: pointer;
            z-index: 6;
            background: transparent;
            border: none;
            outline: none;
        }
        
        .encoder-center-button:hover .encoder-inner {
            background: radial-gradient(circle at 40% 40%, #5a6578, #474a51);
        }
        
        .encoder-center-button:active .encoder-inner {
            transform: scale(0.95);
        }
        
        /* Interactive states */
        .encoder-inner.rotating {
            animation: rotate 0.5s ease-out;
        }
        
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .pressure-value.changing {
            animation: pulse 0.3s ease;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>
    <div class="device-container">
        <div class="interface">
            <!-- Left Encoder -->
            <div class="encoder-container">
                <div class="encoder left" id="leftEncoder">
                    <div class="encoder-outer">
                        <div class="encoder-indicator" id="leftIndicator"></div>
                        <div class="encoder-ring" id="leftRing"></div>
                        <div class="encoder-dots">
                            <!-- 24 dots for visual feedback -->
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                        </div>
                        <button class="encoder-center-button" id="leftButton">
                            <div class="encoder-inner">
                                <div class="encoder-label">MENU</div>
                            </div>
                        </button>
                    </div>
                </div>
                <div class="encoder-info">
                    <div>Menu Navigation</div>
                    <div style="font-size: 12px; margin-top: 5px;">
                        <span style="color: #4a9eff;">⟲</span> Rotate: Navigate<br>
                        <span style="color: #4a9eff;">●</span> Press: Select
                    </div>
                </div>
            </div>
            
            <!-- LCD Display -->
            <div class="lcd-container">
                <div class="lcd-content">
                    <!-- Menu Section -->
                    <div class="menu-section" id="mainMenu">
                        <div class="menu-title">MENU GŁÓWNE</div>
                        <div class="menu-items-container" id="menuItemsContainer">
                            <!-- Menu items will be generated by JavaScript -->
                        </div>
                    </div>
                    
                    <!-- Submenu Section -->
                    <div class="submenu-section" id="submenu">
                        <div class="breadcrumb" id="breadcrumb"></div>
                        <div class="menu-title" id="submenuTitle"></div>
                        <div class="menu-items-container" id="submenuItemsContainer">
                            <!-- Submenu items will be generated by JavaScript -->
                        </div>
                    </div>
                    
                    <!-- Center Section -->
                    <div class="center-section">
                        <div class="center-content" id="centerContent">
                            <div class="logo content-icon">⚡</div>
                            <div class="system-title">TESTER PRO</div>
                            <div class="system-subtitle">System testowania urządzeń</div>
                            <div class="system-version">Wersja 2.1.0</div>
                        </div>
                    </div>
                    
                    <!-- Data Section -->
                    <div class="data-section">
                        <div class="data-title">DANE TESTERA</div>
                        <div class="pressure-item">
                            <div class="pressure-label">Wysokie</div>
                            <div class="pressure-value" id="highPressure">150.2</div>
                            <div class="pressure-unit">bar</div>
                        </div>
                        <div class="pressure-item">
                            <div class="pressure-label">Niskie</div>
                            <div class="pressure-value" id="lowPressure">80.5</div>
                            <div class="pressure-unit">bar</div>
                        </div>
                        <div class="pressure-item">
                            <div class="pressure-label">Średnie</div>
                            <div class="pressure-value" id="medPressure">115.4</div>
                            <div class="pressure-unit">bar</div>
                        </div>
                        <div class="system-status">System Ready</div>
                    </div>
                </div>
            </div>
            
            <!-- Right Encoder -->
            <div class="encoder-container">
                <div class="encoder right" id="rightEncoder">
                    <div class="encoder-outer">
                        <div class="encoder-indicator" id="rightIndicator"></div>
                        <div class="encoder-ring" id="rightRing"></div>
                        <div class="encoder-dots">
                            <!-- 24 dots for visual feedback -->
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                            <div class="encoder-dot"></div>
                        </div>
                        <button class="encoder-center-button" id="rightButton">
                            <div class="encoder-inner">
                                <div class="encoder-label">PRESSURE</div>
                                <div class="encoder-sublabel">CONTROL</div>
                            </div>
                        </button>
                    </div>
                    <div class="pressure-mode-indicators">
                        <div class="pressure-mode-dot active" data-mode="0"></div>
                        <div class="pressure-mode-dot" data-mode="1"></div>
                        <div class="pressure-mode-dot" data-mode="2"></div>
                    </div>
                </div>
                <div class="encoder-info">
                    <div>Pressure Control</div>
                    <div style="font-size: 12px; margin-top: 5px;">
                        <span style="color: #00ff00;">●</span> Press: Mode<br>
                        <span style="color: #00ff00;">⟲</span> Rotate: Adjust
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Menu structure JSON
        const menuStructure = {
            mainMenu: [
                {
                    id: "start",
                    icon: "⚡",
                    label: "Start systemu",
                    hasSubmenu: true,
                    centerContent: {
                        icon: "🚀",
                        title: "Start Systemu",
                        description: "Inicjalizacja systemu testowego",
                        details: "Wybierz tryb pracy z podmenu"
                    },
                    submenu: [
                        {
                            id: "manual",
                            icon: "🎯",
                            label: "Tryb manualny",
                            centerContent: {
                                icon: "🎯",
                                title: "Tryb Manualny",
                                description: "Pełna kontrola nad wszystkimi parametrami testów",
                                details: "Pozwala na ręczne ustawienie ciśnienia, przepływu i czasów testowania"
                            }
                        },
                        {
                            id: "auto",
                            icon: "🤖",
                            label: "Tryb automatyczny",
                            centerContent: {
                                icon: "🤖",
                                title: "Tryb Automatyczny",
                                description: "Automatyczne wykonywanie sekwencji testowych",
                                details: "System sam dobiera parametry na podstawie typu urządzenia"
                            }
                        },
                        {
                            id: "calibration",
                            icon: "📐",
                            label: "Kalibracja",
                            centerContent: {
                                icon: "📐",
                                title: "Kalibracja Systemu",
                                description: "Dostosowanie czujników i parametrów",
                                details: "Przeprowadź kalibrację przed rozpoczęciem testów"
                            }
                        }
                    ]
                },
                {
                    id: "diagnostics",
                    icon: "🔧",
                    label: "Autodiagnostyka",
                    hasSubmenu: true,
                    centerContent: {
                        icon: "🔍",
                        title: "Autodiagnostyka",
                        description: "Sprawdzenie stanu systemu",
                        details: "Wybierz komponent do diagnozy"
                    },
                    submenu: [
                        {
                            id: "sensors",
                            icon: "📊",
                            label: "Test czujników",
                            centerContent: {
                                icon: "📊",
                                title: "Test Czujników",
                                description: "Weryfikacja wszystkich czujników ciśnienia",
                                details: "Status: ✅ Wszystkie czujniki sprawne"
                            }
                        },
                        {
                            id: "pumps",
                            icon: "⚙️",
                            label: "Test pomp",
                            centerContent: {
                                icon: "⚙️",
                                title: "Test Pomp",
                                description: "Sprawdzenie wydajności pomp",
                                details: "Pompa 1: ✅ OK | Pompa 2: ✅ OK"
                            }
                        },
                        {
                            id: "valves",
                            icon: "🔀",
                            label: "Test zaworów",
                            centerContent: {
                                icon: "🔀",
                                title: "Test Zaworów",
                                description: "Kontrola szczelności zaworów",
                                details: "Wszystkie zawory działają poprawnie"
                            }
                        },
                        {
                            id: "system",
                            icon: "💻",
                            label: "Test systemu",
                            centerContent: {
                                icon: "💻",
                                title: "Test Systemu",
                                description: "Kompleksowa diagnostyka",
                                details: "CPU: 45°C | RAM: 2.1GB/4GB | Dysk: 120GB wolne"
                            }
                        }
                    ]
                },
                {
                    id: "login",
                    icon: "👤",
                    label: "Logowanie",
                    hasSubmenu: false,
                    centerContent: {
                        icon: "🔐",
                        title: "Logowanie",
                        description: "Zaloguj się do systemu",
                        details: "Użyj kodu kreskowego lub wprowadź hasło"
                    }
                },
                {
                    id: "remote",
                    icon: "📡",
                    label: "Serwis zdalny",
                    hasSubmenu: true,
                    centerContent: {
                        icon: "🌐",
                        title: "Serwis Zdalny",
                        description: "Połączenie z centrum wsparcia",
                        details: "Wybierz typ połączenia"
                    },
                    submenu: [
                        {
                            id: "support",
                            icon: "💬",
                            label: "Wsparcie online",
                            centerContent: {
                                icon: "💬",
                                title: "Wsparcie Online",
                                description: "Czat z technikiem serwisu",
                                details: "Status: 🟢 Dostępny"
                            }
                        },
                        {
                            id: "remote_access",
                            icon: "🖥️",
                            label: "Zdalny dostęp",
                            centerContent: {
                                icon: "🖥️",
                                title: "Zdalny Dostęp",
                                description: "Umożliw zdalne sterowanie",
                                details: "Kod sesji: TRQ-4521-XYZ"
                            }
                        },
                        {
                            id: "logs",
                            icon: "📋",
                            label: "Wysyłka logów",
                            centerContent: {
                                icon: "📋",
                                title: "Wysyłka Logów",
                                description: "Prześlij logi systemowe do analizy",
                                details: "Ostatnia wysyłka: 2025-01-15 14:30"
                            }
                        }
                    ]
                },
                {
                    id: "settings",
                    icon: "⚙️",
                    label: "Ustawienia",
                    hasSubmenu: true,
                    centerContent: {
                        icon: "🔧",
                        title: "Ustawienia",
                        description: "Konfiguracja systemu",
                        details: "Dostosuj parametry pracy"
                    },
                    submenu: [
                        {
                            id: "language",
                            icon: "🌍",
                            label: "Język",
                            centerContent: {
                                icon: "🌍",
                                title: "Wybór Języka",
                                description: "Zmień język interfejsu",
                                details: "Aktualny: Polski 🇵🇱"
                            }
                        },
                        {
                            id: "network",
                            icon: "📶",
                            label: "Sieć",
                            centerContent: {
                                icon: "📶",
                                title: "Ustawienia Sieci",
                                description: "Konfiguracja połączenia",
                                details: "IP: 192.168.1.100 | Status: Połączono"
                            }
                        },
                        {
                            id: "display",
                            icon: "🖥️",
                            label: "Wyświetlacz",
                            centerContent: {
                                icon: "🖥️",
                                title: "Ustawienia Wyświetlacza",
                                description: "Jasność, kontrast, wygaszacz",
                                details: "Jasność: 80% | Wygaszacz: 5 min"
                            }
                        }
                    ]
                },
                {
                    id: "logout",
                    icon: "🚪",
                    label: "Wyloguj",
                    hasSubmenu: false,
                    centerContent: {
                        icon: "👋",
                        title: "Wylogowanie",
                        description: "Czy na pewno chcesz się wylogować?",
                        details: "Niezapisane dane zostaną utracone"
                    }
                }
            ]
        };
        
        // Interactive functionality
        let currentMenuItem = 0;
        let currentSubmenuItem = 0;
        let leftRotation = 0;
        let rightRotation = 0;
        let pressureMode = 0;
        let isDragging = false;
        let startAngle = 0;
        let currentEncoder = null;
        let lastRotation = 0;
        let rotationSensitivity = 0.3;
        let isInSubmenu = false;
        let currentMenuData = null;
        
        const leftRing = document.getElementById('leftRing');
        const rightRing = document.getElementById('rightRing');
        const leftButton = document.getElementById('leftButton');
        const rightButton = document.getElementById('rightButton');
        const leftIndicator = document.getElementById('leftIndicator');
        const rightIndicator = document.getElementById('rightIndicator');
        const pressureModeDots = document.querySelectorAll('.pressure-mode-dot');
        
        // Render menu
        function renderMenu() {
            const container = document.getElementById('menuItemsContainer');
            container.innerHTML = '';
            
            menuStructure.mainMenu.forEach((item, index) => {
                const menuItem = document.createElement('div');
                menuItem.className = `menu-item ${index === currentMenuItem ? 'active' : ''}`;
                menuItem.dataset.index = index;
                menuItem.innerHTML = `
                    <span class="menu-icon">${item.icon}</span>
                    <span>${item.label}</span>
                    ${item.hasSubmenu ? '<span style="margin-left: auto;">▶</span>' : ''}
                `;
                menuItem.addEventListener('click', () => selectMenuItem(index));
                container.appendChild(menuItem);
            });
        }
        
        // Render submenu
        function renderSubmenu(parentItem) {
            const submenuSection = document.getElementById('submenu');
            const mainMenuSection = document.getElementById('mainMenu');
            const container = document.getElementById('submenuItemsContainer');
            const breadcrumb = document.getElementById('breadcrumb');
            const title = document.getElementById('submenuTitle');
            
            breadcrumb.innerHTML = `
                <span style="cursor: pointer;" onclick="backToMainMenu()">Menu główne</span>
                <span class="breadcrumb-separator">›</span>
                <span>${parentItem.label}</span>
            `;
            
            title.textContent = parentItem.label;
            container.innerHTML = '';
            
            parentItem.submenu.forEach((item, index) => {
                const menuItem = document.createElement('div');
                menuItem.className = `menu-item ${index === currentSubmenuItem ? 'active' : ''}`;
                menuItem.dataset.index = index;
                menuItem.innerHTML = `
                    <span class="menu-icon">${item.icon}</span>
                    <span>${item.label}</span>
                `;
                menuItem.addEventListener('click', () => selectSubmenuItem(index));
                container.appendChild(menuItem);
            });
            
            mainMenuSection.style.display = 'none';
            submenuSection.classList.add('active');
            isInSubmenu = true;
            currentMenuData = parentItem;
            currentSubmenuItem = 0;
        }
        
        // Update center content
        function updateCenterContent(content) {
            const centerContent = document.getElementById('centerContent');
            centerContent.style.opacity = '0';
            
            setTimeout(() => {
                centerContent.innerHTML = `
                    <div class="content-icon">${content.icon}</div>
                    <div class="content-title">${content.title}</div>
                    <div class="content-description">${content.description}</div>
                    ${content.details ? `<div class="content-details">${content.details}</div>` : ''}
                `;
                centerContent.style.opacity = '1';
            }, 300);
        }
        
        // Menu navigation
        function updateMenu() {
            if (isInSubmenu) {
                const submenuItems = document.querySelectorAll('#submenuItemsContainer .menu-item');
                submenuItems.forEach((item, index) => {
                    item.classList.toggle('active', index === currentSubmenuItem);
                });
                if (currentMenuData && currentMenuData.submenu[currentSubmenuItem]) {
                    updateCenterContent(currentMenuData.submenu[currentSubmenuItem].centerContent);
                }
            } else {
                const menuItems = document.querySelectorAll('#menuItemsContainer .menu-item');
                menuItems.forEach((item, index) => {
                    item.classList.toggle('active', index === currentMenuItem);
                });
                updateCenterContent(menuStructure.mainMenu[currentMenuItem].centerContent);
            }
        }
        
        function selectMenuItem(index) {
            currentMenuItem = index;
            const item = menuStructure.mainMenu[index];
            
            if (item.hasSubmenu) {
                renderSubmenu(item);
                updateCenterContent(item.submenu[0].centerContent);
            } else {
                updateCenterContent(item.centerContent);
                updateMenu();
            }
        }
        
        function selectSubmenuItem(index) {
            currentSubmenuItem = index;
            updateMenu();
        }
        
        function backToMainMenu() {
            const submenuSection = document.getElementById('submenu');
            const mainMenuSection = document.getElementById('mainMenu');
            
            submenuSection.classList.remove('active');
            mainMenuSection.style.display = 'flex';
            isInSubmenu = false;
            currentMenuData = null;
            updateMenu();
        }
        
        const pressureValues = {
            high: 150.2,
            medium: 115.4,
            low: 80.5
        };
        
        // Update pressure mode display
        function updatePressureMode() {
            pressureModeDots.forEach((dot, index) => {
                dot.classList.toggle('active', index === pressureMode);
            });
            
            // Highlight active pressure display
            const pressureItems = document.querySelectorAll('.pressure-item');
            pressureItems.forEach((item, index) => {
                if (index === pressureMode) {
                    item.style.border = '2px solid #00ff00';
                    item.style.boxShadow = '0 0 20px rgba(0, 255, 0, 0.3)';
                } else {
                    item.style.border = 'none';
                    item.style.boxShadow = 'none';
                }
            });
        }
        
        // Menu navigation
        function updateMenu() {
            menuItems.forEach((item, index) => {
                item.classList.toggle('active', index === currentMenuItem);
            });
        }
        
        // Encoder rotation handling
        function handleEncoderStart(e, encoderRing) {
            isDragging = true;
            currentEncoder = encoderRing;
            const encoder = encoderRing.closest('.encoder');
            const rect = encoder.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            startAngle = Math.atan2(e.clientY - centerY, e.clientX - centerX);
            lastRotation = 0;
            e.preventDefault();
            
            // Update dots to show active position
            updateEncoderDots(encoder, startAngle);
        }
        
        // Click to rotate functionality
        function handleEncoderClick(e, encoderRing) {
            const encoder = encoderRing.closest('.encoder');
            const rect = encoder.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            const clickAngle = Math.atan2(e.clientY - centerY, e.clientX - centerX);
            const clickDegrees = (clickAngle * 180 / Math.PI + 360) % 360;
            
            // Calculate rotation needed
            const currentDegrees = (encoderRing === leftRing ? leftRotation : rightRotation) % 360;
            let rotationDelta = clickDegrees - currentDegrees;
            
            // Take shortest path
            if (rotationDelta > 180) rotationDelta -= 360;
            if (rotationDelta < -180) rotationDelta += 360;
            
            // Animate rotation
            if (encoderRing === leftRing) {
                animateRotation(leftIndicator, leftRotation, leftRotation + rotationDelta, (value) => {
                    leftRotation = value;
                    leftIndicator.style.transform = `translateX(-50%) rotate(${value}deg)`;
                    
                    // Check for menu change
                    const steps = Math.floor(Math.abs(rotationDelta) / 60);
                    if (steps > 0) {
                        const direction = rotationDelta > 0 ? 1 : -1;
                        for (let i = 0; i < steps; i++) {
                            if (isInSubmenu) {
                                const submenuLength = currentMenuData.submenu.length;
                                currentSubmenuItem = (currentSubmenuItem + direction + submenuLength) % submenuLength;
                            } else {
                                const menuLength = menuStructure.mainMenu.length;
                                currentMenuItem = (currentMenuItem + direction + menuLength) % menuLength;
                            }
                        }
                        updateMenu();
                    }
                });
            } else {
                animateRotation(rightIndicator, rightRotation, rightRotation + rotationDelta, (value) => {
                    rightRotation = value;
                    rightIndicator.style.transform = `translateX(-50%) rotate(${value}deg)`;
                    
                    // Update pressure value
                    const steps = Math.floor(Math.abs(rotationDelta) / 15);
                    if (steps > 0) {
                        const change = (rotationDelta > 0 ? 0.1 : -0.1) * steps;
                        const pressureElements = {
                            0: 'highPressure',
                            1: 'medPressure',
                            2: 'lowPressure'
                        };
                        
                        const element = document.getElementById(pressureElements[pressureMode]);
                        let value = parseFloat(element.textContent);
                        value = Math.max(0, Math.min(200, value + change));
                        element.textContent = value.toFixed(1);
                        element.classList.add('changing');
                        setTimeout(() => element.classList.remove('changing'), 300);
                    }
                });
            }
            
            updateEncoderDots(encoder, clickAngle);
        }
        
        // Animate rotation smoothly
        function animateRotation(element, from, to, onUpdate) {
            const duration = 300;
            const start = performance.now();
            
            function animate(currentTime) {
                const elapsed = currentTime - start;
                const progress = Math.min(elapsed / duration, 1);
                const easeProgress = 1 - Math.pow(1 - progress, 3); // ease-out
                const current = from + (to - from) * easeProgress;
                
                onUpdate(current);
                
                if (progress < 1) {
                    requestAnimationFrame(animate);
                }
            }
            
            requestAnimationFrame(animate);
        }
        
        // Update encoder dots to show position
        function updateEncoderDots(encoder, angle) {
            const dots = encoder.querySelectorAll('.encoder-dot');
            const degrees = (angle * 180 / Math.PI + 360) % 360;
            const activeDot = Math.round(degrees / 15) % 24;
            
            dots.forEach((dot, index) => {
                dot.classList.toggle('active', index === activeDot);
            });
        }
        
        function handleEncoderMove(e) {
            if (!isDragging || !currentEncoder) return;
            
            const encoder = currentEncoder.closest('.encoder');
            const rect = encoder.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            const angle = Math.atan2(e.clientY - centerY, e.clientX - centerX);
            let rotation = (angle - startAngle) * (180 / Math.PI);
            
            // Apply sensitivity for more natural control
            rotation = rotation * rotationSensitivity;
            
            if (currentEncoder === leftRing) {
                leftRotation += rotation - lastRotation;
                leftIndicator.style.transform = `translateX(-50%) rotate(${leftRotation}deg)`;
                
                // Menu navigation with slower response
                if (Math.abs(leftRotation) > 45) {
                    if (isInSubmenu) {
                        const submenuLength = currentMenuData.submenu.length;
                        if (leftRotation > 0) {
                            currentSubmenuItem = (currentSubmenuItem + 1) % submenuLength;
                        } else {
                            currentSubmenuItem = (currentSubmenuItem - 1 + submenuLength) % submenuLength;
                        }
                    } else {
                        const menuLength = menuStructure.mainMenu.length;
                        if (leftRotation > 0) {
                            currentMenuItem = (currentMenuItem + 1) % menuLength;
                        } else {
                            currentMenuItem = (currentMenuItem - 1 + menuLength) % menuLength;
                        }
                    }
                    updateMenu();
                    leftRotation = 0;
                }
            } else if (currentEncoder === rightRing) {
                rightRotation += rotation - lastRotation;
                rightIndicator.style.transform = `translateX(-50%) rotate(${rightRotation}deg)`;
                
                // Pressure adjustment with slower response
                if (Math.abs(rightRotation) > 15) {
                    const change = rightRotation > 0 ? 0.1 : -0.1;
                    const pressureElements = {
                        0: 'highPressure',
                        1: 'medPressure',
                        2: 'lowPressure'
                    };
                    
                    const element = document.getElementById(pressureElements[pressureMode]);
                    let value = parseFloat(element.textContent);
                    value = Math.max(0, Math.min(200, value + change));
                    element.textContent = value.toFixed(1);
                    element.classList.add('changing');
                    setTimeout(() => element.classList.remove('changing'), 300);
                    
                    rightRotation = 0;
                }
            }
            
            lastRotation = rotation;
        }
        
        function handleEncoderEnd() {
            isDragging = false;
            currentEncoder = null;
        }
        
        // Center button click handlers
        leftButton.addEventListener('click', function(e) {
            if (!isDragging) {
                if (isInSubmenu) {
                    const submenuItem = currentMenuData.submenu[currentSubmenuItem];
                    console.log('Selected submenu:', submenuItem.label);
                    // Here you would handle the submenu action
                } else {
                    selectMenuItem(currentMenuItem);
                }
                // Add selection animation
                this.querySelector('.encoder-inner').classList.add('rotating');
                setTimeout(() => this.querySelector('.encoder-inner').classList.remove('rotating'), 500);
            }
        });
        
        rightButton.addEventListener('click', function(e) {
            if (!isDragging) {
                pressureMode = (pressureMode + 1) % 3;
                const modes = ['Wysokie', 'Średnie', 'Niskie'];
                console.log('Pressure mode:', modes[pressureMode]);
                updatePressureMode();
                // Add mode change animation
                this.querySelector('.encoder-inner').classList.add('rotating');
                setTimeout(() => this.querySelector('.encoder-inner').classList.remove('rotating'), 500);
            }
        });
        
        // Ring rotation events - mouse
        leftRing.addEventListener('mousedown', (e) => handleEncoderStart(e, leftRing));
        rightRing.addEventListener('mousedown', (e) => handleEncoderStart(e, rightRing));
        
        // Click to rotate
        leftRing.addEventListener('click', (e) => {
            if (!isDragging) {
                handleEncoderClick(e, leftRing);
            }
        });
        rightRing.addEventListener('click', (e) => {
            if (!isDragging) {
                handleEncoderClick(e, rightRing);
            }
        });
        
        // Ring rotation events - touch
        leftRing.addEventListener('touchstart', (e) => {
            const touch = e.touches[0];
            handleEncoderStart(touch, leftRing);
        });
        rightRing.addEventListener('touchstart', (e) => {
            const touch = e.touches[0];
            handleEncoderStart(touch, rightRing);
        });
        
        document.addEventListener('mousemove', handleEncoderMove);
        document.addEventListener('mouseup', handleEncoderEnd);
        
        document.addEventListener('touchmove', (e) => {
            if (isDragging) {
                const touch = e.touches[0];
                handleEncoderMove(touch);
            }
        });
        document.addEventListener('touchend', handleEncoderEnd);
        
        // Initialize pressure mode display
        updatePressureMode();
        
        // Initialize
        renderMenu();
        updateMenu();
        updatePressureMode();
        
        // Add keyboard support for back navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && isInSubmenu) {
                backToMainMenu();
            }
        });
    </script>
</body>
</html>
